# web3learning
课程学习

# 什么是分布式账本？分布式账本的原理
每一条区块链都是一个分布式账本，所有的交易记录不是存放在一个中央服务器上，而是分散存储在网络中的所有计算节点中，每个节点都有一份交易账本的拷贝，这些拷贝是完全相同且实时更新的。当有新的交易发生时，这个交易会被发送到网络中的所有节点，并通过矿工验证确保其有效性。一旦交易被验证，它就会被添加到账本的最新页面上，也就是区块中，并且这个过程是不可逆的，一旦记录下来，就无法被篡改或删除。

# 区块链的组成方式
以太坊区块链由大到小可以依次分解为：**区块链、区块、交易**三个层次，其中的交易数据、收据数据、状态数据和账户数据都分别存储在四棵默克尔树中，具体如下

# 区块链
区块链是一系列数据块（即“区块”），通过特定的方式相互连接，形成的一条链。每个区块都包含前一个区块的哈希值，称为“父哈希值”（ Parent Hash ），**这是前一个区块内容的唯一标识符**。通过这种方式，每个区块都与前一个区块相连接，形成了一条从第一个区块（创世区块）到最新区块的连续链条，这就是“区块链”。注：第一个区块里无父哈希值。

## 区块
区块链中的每一个区块，都由两个部分组成：区块头（ Header ）和区块体（ Body ）。

### 区块头

1. 父哈希值（ parentHash ）：记录前一个区块的哈希值。
2. 时间戳（ timestamp ）：记录区块创建的具体时间。
3. 随机数（ nonce ）：用于工作量证明（ PoW ）机制中的挖矿过程。
4. 难度目标（ difficulty ）：表示挖矿的难度。
5. 币基（ coinBase ）：标识矿工的账户地址。
*********************************************
另外，区块头里还记录了三个非常重要的根哈希值：
1. 状态树根（ stateRoot ）：表示了区块链的状态树的根哈希值，状态树记录了所有账户的状态信息，如余额、合约代码等。
2. 收据树根（ receiptRoot ）：表示收据树的根哈希值，收据树记录了交易执行的结果，如交易是否成功、交易费用等。
3. 交易树根（ transactionRoot ）：表示交易树的根哈希值，交易树包含了区块中所有交易的信息。

### 区块体
1. 区块体里存储了该区块中的**所有交易数据**，即所有交易哈希的列表。

### 交易
在以太坊中，交易代表从一个账户向另一个账户发送资产或消息的行为。当用户发起一笔交易时，以太坊客户端或钱包软件将会构造交易数据。交易数据主要包含如下字段：
1. nonce：发送方账户的交易计数器，统计该账户在此区块链中的总交易次数。
2. gasPrice：发送方愿意为每单位 gas 支付的价格。
3. gasLimit：发送方为这次交易设置的最大 gas 消耗量。
4. to：接收方的账户地址。
5. value：要传输的以太币数量。
6. data：智能合约相关的字节码。
7. v, r, s：交易签名，由发送方的私钥生成
**交易数据构造完成后，钱包将使用用户的私钥对整个交易进行签名，并将签名结果（ v, r, s ）加入交易数据中**，然后对整个交易数据（不包括签名）计算哈希值，**交易哈希是交易数据的唯一标识符，确保了交易的唯一性和不可篡改**。








